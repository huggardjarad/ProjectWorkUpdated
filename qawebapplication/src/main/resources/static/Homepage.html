<!DOCTYPE html>

<html lang="en">
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .container{
            position:absolute;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.css">
</head>



<body>

<div id='accounts'></div>

<script src="https://fb.me/react-15.0.1.js"></script>
<script src="https://fb.me/react-dom-15.0.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.js"></script>
<script type="text/babel">

    var Navbar = React.createClass({
        render: function () {
           return( <nav className="navbar navbar-expand-lg navbar-light bg-light">
                       <a className="navbar-brand" href="#">AccountApp</a>
                       <button className="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                           <span className="navbar-toggler-icon"></span>
                       </button>
                       <div className="collapse navbar-collapse" id="navbarNavAltMarkup">
                           <div className="navbar-nav">
                               <a className="nav-item nav-link active" href="#" onClick={ (f) => dashboardClick(f)} >DashBoard <span className="sr-only">(current)</span>  </a>
                               <li className="nav-item dropdown">
                                   <a className="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                       Accounts
                                   </a>
                                   <div className="dropdown-menu" aria-labelledby="navbarDropdown">
                                       <a className="dropdown-item" href="#" onClick={ (g) => addAccountClick(g)}>Add Account</a>
                                       <a className="dropdown-item" href="#" onClick={ (e) => handleClick(e)}>Get Accounts</a>

                                   </div>
                               </li>
                           </div>
                       </div>
                   </nav>
           ) }
    });

    var Employee = React.createClass({
        getInitialState: function() {
            return {display: true };
        },
        handleDelete() {
            var self = this;
            $.ajax({
                url: self.props.employee._links.self.href,
                type: 'DELETE',
                success: function(result) {
                    self.setState({display: false});
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    toastr.error('An error has occurred');
                }
            });
        },
        render: function() {
            if (this.state.display===false) return null;
            else return (
                    <tr>
                        <td>{this.props.employee.firstName}</td>
                        <td>{this.props.employee.lastName}</td>
                        <td>{this.props.employee.email}</td>
                        <td>{this.props.employee.password}</td>
                        <button type="submit" className="btn btn-primary" id = "employeeDelete" onClick={this.handleDelete}>Delete</button>

                    </tr>);
        }
    });
    var EmployeeTable = React.createClass({
        render: function() {
            var rows = [];
            this.props.employees.forEach(function(employee) {
                rows.push(<Employee employee={employee} />);
            });
            return (

                    <div className="container">
                        <Navbar />
                        <table className="table table-striped">
                            <thead>
                            <tr>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>E-mail</th>
                                <th>Password</th>
                            </tr>
                            </thead>
                            <tbody>{rows}</tbody>
                        </table>
                    </div>
            )}
    });

    var DatabaseAccounts = React.createClass({

        loadEmployeesFromServer: function () {
            var self = this;
            $.ajax({
                url: "http://localhost:8080/api/employees"
            }).then(function (data) {
                self.setState({employees: data._embedded.employees});
            });
        },

        getInitialState: function () {
            return {employees: []};
        },

        componentDidMount: function () {
            this.loadEmployeesFromServer();
        },

        render() {
            return ( <EmployeeTable employees={this.state.employees}/> );
        }
    });

    var DashBoard = React.createClass({
        render: function(){
            return (
                    <div id = "dashboard" className="jumbotron">
                        <Navbar />
                        <h1 className="display-4">Hello, User!</h1>
                        <p className="lead">Welcome to the dashboard of QA's user control app!</p>
                        <h1 className="my-4">
                            <p>Please select a tab from "Accounts" to perform the action you wish.</p>
                        </h1>
                    </div>
            )

        }
    });
    var AddAccountForm = React.createClass({
        render: function(){
            return(
                    <form onSubmit={this.onSubmit}>
                        <Navbar />
                        <div className="form-group">
                            <label htmlFor="fNameInput">First Name:</label>
                            <input type="text" className="form-control" id="fNameInput" placeholder="First Name" onChange={this.onChange}></input>
                        </div>
                        <div className="form-group">
                            <label htmlFor="lNameInput">Last Name:</label>
                            <input type="text" className="form-control" id="lNameInput" placeholder="Last Name" onChange={this.onChange}></input>
                        </div>

                        <div className="form-group">
                            <label htmlFor="inputEmail">Email address:</label>
                            <input type="email" className="form-control" id="inputEmail1" aria-describedby="emailHelp" placeholder="Enter email" onChange={this.onChange}></input>
                        </div>

                        <div className="form-group">
                            <label htmlFor="inputPassword">Password:</label>
                            <input type="password" className="form-control" id="inputPassword1" placeholder="Password" onChange={this.onChange}></input>
                        </div>

                        <button type="submit" className="btn btn-primary">Add Account</button>
                    </form>

            )
        }
    });


    function handleClick(e){
        e.preventDefault();
        ReactDOM.render(
            <DatabaseAccounts />, document.getElementById('accounts')
        )
    }
    function dashboardClick(f){
        f.preventDefault();
        ReactDOM.render(
            <DashBoard />, document.getElementById('accounts')
        )
    }
    function addAccountClick(g){
        g.preventDefault();
        ReactDOM.render(
            <AddAccountForm />, document.getElementById('accounts')
        )
    }
    function onSubmit(e){
        e.preventDefault()
    }
    function onChange(e){
        e.preventDefault()
    }


    ReactDOM.render(
            <DashBoard />, document.getElementById('accounts')
    );
</script>

</body>
</html>